<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.9 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC7540 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7540.xml">
<!ENTITY RFC8288 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8288.xml">
<!ENTITY I-D.ietf-httpbis-header-structure SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-httpbis-header-structure.xml">
<!ENTITY W3C.CR-preload-20171026 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml4/reference.W3C.CR-preload-20171026.xml">
<!ENTITY RFC4287 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4287.xml">
]>


<rfc docName="draft-pot-prefer-push-01" category="std">

  <front>
    <title>HTTP-client suggested Push Preference</title>

    <author initials="E." surname="Pot" fullname="Evert Pot">
      <organization></organization>
      <address>
        <email>me@evertpot.com</email>
        <uri>https://evertpot.com/</uri>
      </address>
    </author>

    <date year="2018" month="December" day="02"/>

    
    
    

    <abstract>


<t>A header for enabling HTTP clients to indicate that a Push for specific
related resources might be desired.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>HTTP/2 <xref target="RFC7540"/> allows a server to push request and response pairs to
HTTP clients. This can save round-trips between server and client and
reduces the total time required for a client to retrieve all requested
resources.</t>

<t>This mechanism is completely controlled by the server, and it is up to
implementors of services to anticipate what resources a client might need
next.</t>

<t>This specification defines a new HTTP header that allows a client to inform a
server of resources they will require next based on a link relation type
<xref target="RFC8288"/>.</t>

</section>
<section anchor="rationale" title="Rationale">

<t>Many HTTP-based services provide some mechanism to embed the HTTP response
bodies of resources into other HTTP resource. A common example of this is when
a resource is structured as a “collection of resources”. Examples of this
include:</t>

<t><list style="symbols">
  <t>The Atom Syndication Format <xref target="RFC4287"/> that encodes <spanx style="verb">ATOM:entry</spanx> XML
elements for each subordinate.</t>
  <t>The <xref target="HAL"></xref> format, which provides an <spanx style="verb">_embedded</spanx> element to embedding bodies
of resources in other resources.</t>
  <t>The <xref target="JSON-API"></xref> format, which provides a <spanx style="verb">included</spanx> property to embed
resources.</t>
</list></t>

<t>Embedding resource responses in other resources has two major peformance
advantages:</t>

<t><list style="numbers">
  <t>It reduces the number of roundtrips. A client can make a single HTTP request
and get many responses.</t>
  <t>Generating a related set of resources can often be implemented on a server
to be less time consuming that generating each response individually.</t>
</list></t>

<t>These mechanism also poses an issue. HTTP clients and intermediaries are not
aware of these embedded resources, because there was never a true HTTP request.</t>

<t>By leveraging HTTP/2 push instead of format-specific embedding mechanisms,
it’s possible for services to push subordinate resources as soon as possible,
generate HTTP responses as a “set” all while still taking advantage of existing
HTTP infrastructure. Another advantage of HTTP/2 push over embedding it that
it allows resources of mixed mediatypes to be pushed.</t>

<t>In many REST apis, sub-ordiniate or embedded resources are identified by their
link relation. By using the link relation, it will be possible for a client
to indicate to a server which links they intent to follow, allowing a server
to only push the resources that the client knows it will need.</t>

</section>
<section anchor="the-header-format" title="The header format">

<t>This format should uses the “List” format from the Structured Headers format
<xref target="I-D.ietf-httpbis-header-structure"/>.</t>

<figure><artwork><![CDATA[
GET /articles HTTP/1.1
Prefer-Push: item, author, "https://example.org/custom-rel"
]]></artwork></figure>

</section>
<section anchor="handling-a-prefer-push-request" title="Handling a Prefer-Push request">

<t>When a server receives the <spanx style="verb">Prefer-Push</spanx> header, it can choose to push the
related resources. It’s up to the discretion of the implementor to decide
which resources to push. A server is also free to ignore push-requests.</t>

<t><xref target="RFC8288"/> defines Web Links as an abstract concept that can be specified
in a variety of ways. It defines the HTTP “Link” header as a specific
serialization. Like <xref target="RFC8288"/>, this specification is not dependent on the
serialization of the Web Link.</t>

</section>
<section anchor="using-with-preload-relationship-types" title="Using with “preload” relationship types">

<t><xref target="W3C.CR-preload-20171026"/> defines a <spanx style="verb">preload</spanx> relationship type. This
relationship type can be used by an origin to inform a client or intermediate
to start fetching a resource, or a proxy to initiate a HTTP/2 push.</t>

<t>A distinct difference between <spanx style="verb">preload</spanx> and <spanx style="verb">Prefer-Push</spanx> is that <spanx style="verb">preload</spanx>
can be used by origin servers to inform clients and intermediates to fetch
and potentially push resources optimistically, but fundamentally <spanx style="verb">Prefer-Push</spanx>
is a completely client-driven mechanism.</t>

<t>As such, these features can co-exist.</t>

</section>
<section anchor="security-considerations" title="Security considerations">

<t>The Prefer-Push mechanism can potentially result in a large number of
resources being pushed. This can result in a Denial-of-Service attack.</t>

<t>A server must set reasonable restrictions around the amount of pushes it
sends. In the case of N-Depth pushes, servers SHOULD also set restrictions
around the depth it supports.</t>

</section>
<section anchor="iana-considerations" title="IANA considerations">

<t>This document defines the <spanx style="verb">Prefer-Push</spanx> HTTP request fields and registers
them in the Permanent Message Header Fields registry.</t>

<section anchor="prefer-push" title="Prefer-Push">
<t><list style="symbols">
  <t>Header field name: Prefer-Push</t>
  <t>Applicable protocol: HTTP</t>
  <t>Status: standard</t>
  <t>Author/Change controller: IETF</t>
  <t>Specification document(s): <xref target="prefer-push"/> of this document</t>
  <t>Related information: for Client Hints</t>
</list></t>

</section>
</section>
<section anchor="acknowledgements" title="Acknowledgements">

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC7540;
&RFC8288;
&I-D.ietf-httpbis-header-structure;
&W3C.CR-preload-20171026;


    </references>

    <references title='Informative References'>

&RFC4287;
<reference anchor="HAL" target="https://tools.ietf.org/html/draft-kelly-json-hal-00">
  <front>
    <title>JSON Hypertext Application Language</title>
    <author initials="M." surname="Kelly" fullname="Mike Kelly">
      <organization></organization>
    </author>
    <date year="2012" month="June" day="07"/>
  </front>
</reference>
<reference anchor="JSON-API" target="https://jsonapi.org/format/">
  <front>
    <title>JSON:API</title>
    <author >
      <organization></organization>
    </author>
    <date year="n.d."/>
  </front>
</reference>


    </references>


<section anchor="example" title="Example">

<t>A server serves a document with a JSON-based media-type. The following example
document might represent a list of articles:</t>

<figure><artwork><![CDATA[
HTTP/1.1 200 OK
Content-Type: application/vnd.example.links+json

{
   "links": [
      { "rel": "item", "href": "/article/1" },
      { "rel": "item", "href": "/article/2" },
      { "rel": "item", "href": "/article/3" },
      { "rel": "item", "href": "/article/4" },
      { "rel": "item", "href": "/article/5" }
   ]
   "total" : 5,
}
]]></artwork></figure>

<t>A “Prefer-Push”-enabled client knows it will want to receive the full
representations of all articles. When the client receives the list of
articles via a “GET” request, it can indicate this preference with
the “Prefer-Push” header:</t>

<figure><artwork><![CDATA[
GET /article HTTP/1.1
Accept: application/vnd.example.links+json
Prefer-Push: item
]]></artwork></figure>

<t>Upon recieving this request, server may immediately generate the request
and response pairs for every “item” link in the collection and initiate
push streams for each.</t>

</section>
<section anchor="changelog" title="Changelog">

<section anchor="changes-since-00" title="Changes since -00">

<t><list style="symbols">
  <t>Added an abstract</t>
</list></t>

</section>
</section>


  </back>

<!-- ##markdown-source:
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
gBPpnld8Lxc8Jo0oovgfX1VUfREYAAA=

-->

</rfc>

